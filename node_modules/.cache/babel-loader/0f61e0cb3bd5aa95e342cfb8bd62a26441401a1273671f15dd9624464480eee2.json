{"ast":null,"code":"//  SPDX-License-Identifier: LGPL-2.1-or-later\n//  Copyright (c) 2015-2024 MariaDB Corporation Ab\n\n'use strict';\n\nconst Execute = require('./execute');\nconst {\n  Readable\n} = require('stream');\n\n/**\n * Protocol COM_STMT_EXECUTE with streaming events.\n * see : https://mariadb.com/kb/en/com_stmt_execute/\n */\nclass ExecuteStream extends Execute {\n  constructor(cmdParam, connOpts, prepare, socket) {\n    super(() => {}, () => {}, connOpts, cmdParam, prepare);\n    this.socket = socket;\n    this.inStream = new Readable({\n      objectMode: true,\n      read: () => {\n        this.socket.resume();\n      }\n    });\n    this.on('fields', function (meta) {\n      this.inStream.emit('fields', meta);\n    });\n    this.on('error', function (err) {\n      this.inStream.emit('error', err);\n    });\n    this.on('close', function (err) {\n      this.inStream.emit('error', err);\n    });\n    this.on('end', function (err) {\n      if (err) this.inStream.emit('error', err);\n      this.socket.resume();\n      this.inStream.push(null);\n    });\n    this.inStream.close = function () {\n      this.handleNewRows = () => {};\n      this.socket.resume();\n    }.bind(this);\n  }\n  handleNewRows(row) {\n    if (!this.inStream.push(row)) {\n      this.socket.pause();\n    }\n  }\n}\nmodule.exports = ExecuteStream;","map":{"version":3,"names":["Execute","require","Readable","ExecuteStream","constructor","cmdParam","connOpts","prepare","socket","inStream","objectMode","read","resume","on","meta","emit","err","push","close","handleNewRows","bind","row","pause","module","exports"],"sources":["D:/Ale lui Vlad/Projects/SpotiForums/spotiforums/node_modules/mariadb/lib/cmd/execute-stream.js"],"sourcesContent":["//  SPDX-License-Identifier: LGPL-2.1-or-later\n//  Copyright (c) 2015-2024 MariaDB Corporation Ab\n\n'use strict';\n\nconst Execute = require('./execute');\nconst { Readable } = require('stream');\n\n/**\n * Protocol COM_STMT_EXECUTE with streaming events.\n * see : https://mariadb.com/kb/en/com_stmt_execute/\n */\nclass ExecuteStream extends Execute {\n  constructor(cmdParam, connOpts, prepare, socket) {\n    super(\n      () => {},\n      () => {},\n      connOpts,\n      cmdParam,\n      prepare\n    );\n    this.socket = socket;\n    this.inStream = new Readable({\n      objectMode: true,\n      read: () => {\n        this.socket.resume();\n      }\n    });\n\n    this.on('fields', function (meta) {\n      this.inStream.emit('fields', meta);\n    });\n\n    this.on('error', function (err) {\n      this.inStream.emit('error', err);\n    });\n\n    this.on('close', function (err) {\n      this.inStream.emit('error', err);\n    });\n\n    this.on('end', function (err) {\n      if (err) this.inStream.emit('error', err);\n      this.socket.resume();\n      this.inStream.push(null);\n    });\n\n    this.inStream.close = function () {\n      this.handleNewRows = () => {};\n      this.socket.resume();\n    }.bind(this);\n  }\n\n  handleNewRows(row) {\n    if (!this.inStream.push(row)) {\n      this.socket.pause();\n    }\n  }\n}\n\nmodule.exports = ExecuteStream;\n"],"mappings":"AAAA;AACA;;AAEA,YAAY;;AAEZ,MAAMA,OAAO,GAAGC,OAAO,CAAC,WAAW,CAAC;AACpC,MAAM;EAAEC;AAAS,CAAC,GAAGD,OAAO,CAAC,QAAQ,CAAC;;AAEtC;AACA;AACA;AACA;AACA,MAAME,aAAa,SAASH,OAAO,CAAC;EAClCI,WAAWA,CAACC,QAAQ,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,MAAM,EAAE;IAC/C,KAAK,CACH,MAAM,CAAC,CAAC,EACR,MAAM,CAAC,CAAC,EACRF,QAAQ,EACRD,QAAQ,EACRE,OACF,CAAC;IACD,IAAI,CAACC,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,QAAQ,GAAG,IAAIP,QAAQ,CAAC;MAC3BQ,UAAU,EAAE,IAAI;MAChBC,IAAI,EAAEA,CAAA,KAAM;QACV,IAAI,CAACH,MAAM,CAACI,MAAM,CAAC,CAAC;MACtB;IACF,CAAC,CAAC;IAEF,IAAI,CAACC,EAAE,CAAC,QAAQ,EAAE,UAAUC,IAAI,EAAE;MAChC,IAAI,CAACL,QAAQ,CAACM,IAAI,CAAC,QAAQ,EAAED,IAAI,CAAC;IACpC,CAAC,CAAC;IAEF,IAAI,CAACD,EAAE,CAAC,OAAO,EAAE,UAAUG,GAAG,EAAE;MAC9B,IAAI,CAACP,QAAQ,CAACM,IAAI,CAAC,OAAO,EAAEC,GAAG,CAAC;IAClC,CAAC,CAAC;IAEF,IAAI,CAACH,EAAE,CAAC,OAAO,EAAE,UAAUG,GAAG,EAAE;MAC9B,IAAI,CAACP,QAAQ,CAACM,IAAI,CAAC,OAAO,EAAEC,GAAG,CAAC;IAClC,CAAC,CAAC;IAEF,IAAI,CAACH,EAAE,CAAC,KAAK,EAAE,UAAUG,GAAG,EAAE;MAC5B,IAAIA,GAAG,EAAE,IAAI,CAACP,QAAQ,CAACM,IAAI,CAAC,OAAO,EAAEC,GAAG,CAAC;MACzC,IAAI,CAACR,MAAM,CAACI,MAAM,CAAC,CAAC;MACpB,IAAI,CAACH,QAAQ,CAACQ,IAAI,CAAC,IAAI,CAAC;IAC1B,CAAC,CAAC;IAEF,IAAI,CAACR,QAAQ,CAACS,KAAK,GAAG,YAAY;MAChC,IAAI,CAACC,aAAa,GAAG,MAAM,CAAC,CAAC;MAC7B,IAAI,CAACX,MAAM,CAACI,MAAM,CAAC,CAAC;IACtB,CAAC,CAACQ,IAAI,CAAC,IAAI,CAAC;EACd;EAEAD,aAAaA,CAACE,GAAG,EAAE;IACjB,IAAI,CAAC,IAAI,CAACZ,QAAQ,CAACQ,IAAI,CAACI,GAAG,CAAC,EAAE;MAC5B,IAAI,CAACb,MAAM,CAACc,KAAK,CAAC,CAAC;IACrB;EACF;AACF;AAEAC,MAAM,CAACC,OAAO,GAAGrB,aAAa","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}