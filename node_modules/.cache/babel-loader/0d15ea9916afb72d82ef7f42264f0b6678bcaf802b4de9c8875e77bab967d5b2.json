{"ast":null,"code":"//  SPDX-License-Identifier: LGPL-2.1-or-later\n//  Copyright (c) 2015-2024 MariaDB Corporation Ab\n\n'use strict';\n\nconst Capabilities = require('../../const/capabilities');\n\n/**\n * Send SSL Request packet.\n * see : https://mariadb.com/kb/en/library/1-connecting-connecting/#sslrequest-packet\n *\n * @param cmd     current command\n * @param out     output writer\n * @param info    client information\n * @param opts    connection options\n */\nmodule.exports.send = function sendSSLRequest(cmd, out, info, opts) {\n  out.startPacket(cmd);\n  out.writeInt32(Number(info.clientCapabilities & BigInt(0xffffffff)));\n  out.writeInt32(1024 * 1024 * 1024); // max packet size\n  out.writeInt8(opts.collation && opts.collation.index <= 255 ? opts.collation.index : 224);\n  for (let i = 0; i < 19; i++) {\n    out.writeInt8(0);\n  }\n  if (info.serverCapabilities & Capabilities.MYSQL) {\n    out.writeInt32(0);\n  } else {\n    out.writeInt32(Number(info.clientCapabilities >> 32n));\n  }\n  out.flushPacket();\n};","map":{"version":3,"names":["Capabilities","require","module","exports","send","sendSSLRequest","cmd","out","info","opts","startPacket","writeInt32","Number","clientCapabilities","BigInt","writeInt8","collation","index","i","serverCapabilities","MYSQL","flushPacket"],"sources":["D:/Ale lui Vlad/Projects/SpotiForums/spotiforums/node_modules/mariadb/lib/cmd/handshake/ssl-request.js"],"sourcesContent":["//  SPDX-License-Identifier: LGPL-2.1-or-later\n//  Copyright (c) 2015-2024 MariaDB Corporation Ab\n\n'use strict';\nconst Capabilities = require('../../const/capabilities');\n\n/**\n * Send SSL Request packet.\n * see : https://mariadb.com/kb/en/library/1-connecting-connecting/#sslrequest-packet\n *\n * @param cmd     current command\n * @param out     output writer\n * @param info    client information\n * @param opts    connection options\n */\nmodule.exports.send = function sendSSLRequest(cmd, out, info, opts) {\n  out.startPacket(cmd);\n  out.writeInt32(Number(info.clientCapabilities & BigInt(0xffffffff)));\n  out.writeInt32(1024 * 1024 * 1024); // max packet size\n  out.writeInt8(opts.collation && opts.collation.index <= 255 ? opts.collation.index : 224);\n  for (let i = 0; i < 19; i++) {\n    out.writeInt8(0);\n  }\n\n  if (info.serverCapabilities & Capabilities.MYSQL) {\n    out.writeInt32(0);\n  } else {\n    out.writeInt32(Number(info.clientCapabilities >> 32n));\n  }\n\n  out.flushPacket();\n};\n"],"mappings":"AAAA;AACA;;AAEA,YAAY;;AACZ,MAAMA,YAAY,GAAGC,OAAO,CAAC,0BAA0B,CAAC;;AAExD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,MAAM,CAACC,OAAO,CAACC,IAAI,GAAG,SAASC,cAAcA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAEC,IAAI,EAAE;EAClEF,GAAG,CAACG,WAAW,CAACJ,GAAG,CAAC;EACpBC,GAAG,CAACI,UAAU,CAACC,MAAM,CAACJ,IAAI,CAACK,kBAAkB,GAAGC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC;EACpEP,GAAG,CAACI,UAAU,CAAC,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC;EACpCJ,GAAG,CAACQ,SAAS,CAACN,IAAI,CAACO,SAAS,IAAIP,IAAI,CAACO,SAAS,CAACC,KAAK,IAAI,GAAG,GAAGR,IAAI,CAACO,SAAS,CAACC,KAAK,GAAG,GAAG,CAAC;EACzF,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,EAAE,EAAEA,CAAC,EAAE,EAAE;IAC3BX,GAAG,CAACQ,SAAS,CAAC,CAAC,CAAC;EAClB;EAEA,IAAIP,IAAI,CAACW,kBAAkB,GAAGnB,YAAY,CAACoB,KAAK,EAAE;IAChDb,GAAG,CAACI,UAAU,CAAC,CAAC,CAAC;EACnB,CAAC,MAAM;IACLJ,GAAG,CAACI,UAAU,CAACC,MAAM,CAACJ,IAAI,CAACK,kBAAkB,IAAI,GAAG,CAAC,CAAC;EACxD;EAEAN,GAAG,CAACc,WAAW,CAAC,CAAC;AACnB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}