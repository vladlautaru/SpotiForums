{"ast":null,"code":"//  SPDX-License-Identifier: LGPL-2.1-or-later\n//  Copyright (c) 2015-2024 MariaDB Corporation Ab\n\n'use strict';\n\nconst Command = require('./command');\nconst ServerStatus = require('../const/server-status');\nconst RESET_COMMAND = new Uint8Array([1, 0, 0, 0, 0x1f]);\n/**\n * send a COM_RESET_CONNECTION: permits to reset a connection without re-authentication.\n * see https://mariadb.com/kb/en/library/com_reset_connection/\n */\nclass Reset extends Command {\n  constructor(cmdParam, resolve, reject) {\n    super(cmdParam, resolve, reject);\n  }\n  start(out, opts, info) {\n    if (opts.logger.query) opts.logger.query('RESET');\n    this.onPacketReceive = this.readResetResponsePacket;\n    out.fastFlush(this, RESET_COMMAND);\n    this.emit('send_end');\n  }\n\n  /**\n   * Read response packet.\n   * packet can be :\n   * - an ERR_Packet\n   * - a OK_Packet\n   *\n   * @param packet  query response\n   * @param out     output writer\n   * @param opts    connection options\n   * @param info    connection info\n   */\n  readResetResponsePacket(packet, out, opts, info) {\n    packet.skip(1); //skip header\n    packet.skipLengthCodedNumber(); //affected rows\n    packet.skipLengthCodedNumber(); //insert ids\n\n    info.status = packet.readUInt16();\n    if (info.redirectRequest && (info.status & ServerStatus.STATUS_IN_TRANS) === 0) {\n      info.redirect(info.redirectRequest, this.successEnd.bind(this));\n    } else {\n      this.successEnd();\n    }\n  }\n}\nmodule.exports = Reset;","map":{"version":3,"names":["Command","require","ServerStatus","RESET_COMMAND","Uint8Array","Reset","constructor","cmdParam","resolve","reject","start","out","opts","info","logger","query","onPacketReceive","readResetResponsePacket","fastFlush","emit","packet","skip","skipLengthCodedNumber","status","readUInt16","redirectRequest","STATUS_IN_TRANS","redirect","successEnd","bind","module","exports"],"sources":["D:/Ale lui Vlad/Projects/SpotiForums/spotiforums/node_modules/mariadb/lib/cmd/reset.js"],"sourcesContent":["//  SPDX-License-Identifier: LGPL-2.1-or-later\n//  Copyright (c) 2015-2024 MariaDB Corporation Ab\n\n'use strict';\n\nconst Command = require('./command');\nconst ServerStatus = require('../const/server-status');\nconst RESET_COMMAND = new Uint8Array([1, 0, 0, 0, 0x1f]);\n/**\n * send a COM_RESET_CONNECTION: permits to reset a connection without re-authentication.\n * see https://mariadb.com/kb/en/library/com_reset_connection/\n */\nclass Reset extends Command {\n  constructor(cmdParam, resolve, reject) {\n    super(cmdParam, resolve, reject);\n  }\n\n  start(out, opts, info) {\n    if (opts.logger.query) opts.logger.query('RESET');\n    this.onPacketReceive = this.readResetResponsePacket;\n    out.fastFlush(this, RESET_COMMAND);\n    this.emit('send_end');\n  }\n\n  /**\n   * Read response packet.\n   * packet can be :\n   * - an ERR_Packet\n   * - a OK_Packet\n   *\n   * @param packet  query response\n   * @param out     output writer\n   * @param opts    connection options\n   * @param info    connection info\n   */\n  readResetResponsePacket(packet, out, opts, info) {\n    packet.skip(1); //skip header\n    packet.skipLengthCodedNumber(); //affected rows\n    packet.skipLengthCodedNumber(); //insert ids\n\n    info.status = packet.readUInt16();\n    if (info.redirectRequest && (info.status & ServerStatus.STATUS_IN_TRANS) === 0) {\n      info.redirect(info.redirectRequest, this.successEnd.bind(this));\n    } else {\n      this.successEnd();\n    }\n  }\n}\n\nmodule.exports = Reset;\n"],"mappings":"AAAA;AACA;;AAEA,YAAY;;AAEZ,MAAMA,OAAO,GAAGC,OAAO,CAAC,WAAW,CAAC;AACpC,MAAMC,YAAY,GAAGD,OAAO,CAAC,wBAAwB,CAAC;AACtD,MAAME,aAAa,GAAG,IAAIC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;AACxD;AACA;AACA;AACA;AACA,MAAMC,KAAK,SAASL,OAAO,CAAC;EAC1BM,WAAWA,CAACC,QAAQ,EAAEC,OAAO,EAAEC,MAAM,EAAE;IACrC,KAAK,CAACF,QAAQ,EAAEC,OAAO,EAAEC,MAAM,CAAC;EAClC;EAEAC,KAAKA,CAACC,GAAG,EAAEC,IAAI,EAAEC,IAAI,EAAE;IACrB,IAAID,IAAI,CAACE,MAAM,CAACC,KAAK,EAAEH,IAAI,CAACE,MAAM,CAACC,KAAK,CAAC,OAAO,CAAC;IACjD,IAAI,CAACC,eAAe,GAAG,IAAI,CAACC,uBAAuB;IACnDN,GAAG,CAACO,SAAS,CAAC,IAAI,EAAEf,aAAa,CAAC;IAClC,IAAI,CAACgB,IAAI,CAAC,UAAU,CAAC;EACvB;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEF,uBAAuBA,CAACG,MAAM,EAAET,GAAG,EAAEC,IAAI,EAAEC,IAAI,EAAE;IAC/CO,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;IAChBD,MAAM,CAACE,qBAAqB,CAAC,CAAC,CAAC,CAAC;IAChCF,MAAM,CAACE,qBAAqB,CAAC,CAAC,CAAC,CAAC;;IAEhCT,IAAI,CAACU,MAAM,GAAGH,MAAM,CAACI,UAAU,CAAC,CAAC;IACjC,IAAIX,IAAI,CAACY,eAAe,IAAI,CAACZ,IAAI,CAACU,MAAM,GAAGrB,YAAY,CAACwB,eAAe,MAAM,CAAC,EAAE;MAC9Eb,IAAI,CAACc,QAAQ,CAACd,IAAI,CAACY,eAAe,EAAE,IAAI,CAACG,UAAU,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;IACjE,CAAC,MAAM;MACL,IAAI,CAACD,UAAU,CAAC,CAAC;IACnB;EACF;AACF;AAEAE,MAAM,CAACC,OAAO,GAAG1B,KAAK","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}