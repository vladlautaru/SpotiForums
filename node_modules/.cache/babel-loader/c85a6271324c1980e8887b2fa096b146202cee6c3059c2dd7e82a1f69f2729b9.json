{"ast":null,"code":"//  SPDX-License-Identifier: LGPL-2.1-or-later\n//  Copyright (c) 2015-2024 MariaDB Corporation Ab\n\n'use strict';\n\nclass ConnectionInformation {\n  #redirectFct;\n  constructor(opts, redirectFct) {\n    this.threadId = -1;\n    this.status = null;\n    this.serverVersion = null;\n    this.serverCapabilities = null;\n    this.database = opts.database;\n    this.port = opts.port;\n    this.#redirectFct = redirectFct;\n    this.redirectRequest = null;\n  }\n  hasMinVersion(major, minor, patch) {\n    if (!this.serverVersion) throw new Error('cannot know if server version until connection is established');\n    if (!major) throw new Error('a major version must be set');\n    if (!minor) minor = 0;\n    if (!patch) patch = 0;\n    let ver = this.serverVersion;\n    return ver.major > major || ver.major === major && ver.minor > minor || ver.major === major && ver.minor === minor && ver.patch >= patch;\n  }\n  redirect(value, resolve) {\n    return this.#redirectFct(value, resolve);\n  }\n  isMariaDB() {\n    if (!this.serverVersion) throw new Error('cannot know if server is MariaDB until connection is established');\n    return this.serverVersion.mariaDb;\n  }\n\n  /**\n   * Parse raw info to set server major/minor/patch values\n   * @param info\n   */\n  static parseVersionString(info) {\n    let car;\n    let offset = 0;\n    let type = 0;\n    let val = 0;\n    for (; offset < info.serverVersion.raw.length; offset++) {\n      car = info.serverVersion.raw.charCodeAt(offset);\n      if (car < 48 || car > 57) {\n        switch (type) {\n          case 0:\n            info.serverVersion.major = val;\n            break;\n          case 1:\n            info.serverVersion.minor = val;\n            break;\n          case 2:\n            info.serverVersion.patch = val;\n            return;\n        }\n        type++;\n        val = 0;\n      } else {\n        val = val * 10 + car - 48;\n      }\n    }\n    //serverVersion finished by number like \"5.5.57\", assign patchVersion\n    if (type === 2) info.serverVersion.patch = val;\n  }\n}\nmodule.exports = ConnectionInformation;","map":{"version":3,"names":["ConnectionInformation","redirectFct","constructor","opts","threadId","status","serverVersion","serverCapabilities","database","port","redirectRequest","hasMinVersion","major","minor","patch","Error","ver","redirect","value","resolve","isMariaDB","mariaDb","parseVersionString","info","car","offset","type","val","raw","length","charCodeAt","module","exports"],"sources":["D:/Ale lui Vlad/Projects/SpotiForums/spotiforums/node_modules/mariadb/lib/misc/connection-information.js"],"sourcesContent":["//  SPDX-License-Identifier: LGPL-2.1-or-later\n//  Copyright (c) 2015-2024 MariaDB Corporation Ab\n\n'use strict';\n\nclass ConnectionInformation {\n  #redirectFct;\n  constructor(opts, redirectFct) {\n    this.threadId = -1;\n    this.status = null;\n    this.serverVersion = null;\n    this.serverCapabilities = null;\n    this.database = opts.database;\n    this.port = opts.port;\n    this.#redirectFct = redirectFct;\n    this.redirectRequest = null;\n  }\n\n  hasMinVersion(major, minor, patch) {\n    if (!this.serverVersion) throw new Error('cannot know if server version until connection is established');\n\n    if (!major) throw new Error('a major version must be set');\n\n    if (!minor) minor = 0;\n    if (!patch) patch = 0;\n\n    let ver = this.serverVersion;\n    return (\n      ver.major > major ||\n      (ver.major === major && ver.minor > minor) ||\n      (ver.major === major && ver.minor === minor && ver.patch >= patch)\n    );\n  }\n\n  redirect(value, resolve) {\n    return this.#redirectFct(value, resolve);\n  }\n\n  isMariaDB() {\n    if (!this.serverVersion) throw new Error('cannot know if server is MariaDB until connection is established');\n    return this.serverVersion.mariaDb;\n  }\n\n  /**\n   * Parse raw info to set server major/minor/patch values\n   * @param info\n   */\n  static parseVersionString(info) {\n    let car;\n    let offset = 0;\n    let type = 0;\n    let val = 0;\n\n    for (; offset < info.serverVersion.raw.length; offset++) {\n      car = info.serverVersion.raw.charCodeAt(offset);\n      if (car < 48 || car > 57) {\n        switch (type) {\n          case 0:\n            info.serverVersion.major = val;\n            break;\n          case 1:\n            info.serverVersion.minor = val;\n            break;\n          case 2:\n            info.serverVersion.patch = val;\n            return;\n        }\n        type++;\n        val = 0;\n      } else {\n        val = val * 10 + car - 48;\n      }\n    }\n    //serverVersion finished by number like \"5.5.57\", assign patchVersion\n    if (type === 2) info.serverVersion.patch = val;\n  }\n}\n\nmodule.exports = ConnectionInformation;\n"],"mappings":"AAAA;AACA;;AAEA,YAAY;;AAEZ,MAAMA,qBAAqB,CAAC;EAC1B,CAACC,WAAW;EACZC,WAAWA,CAACC,IAAI,EAAEF,WAAW,EAAE;IAC7B,IAAI,CAACG,QAAQ,GAAG,CAAC,CAAC;IAClB,IAAI,CAACC,MAAM,GAAG,IAAI;IAClB,IAAI,CAACC,aAAa,GAAG,IAAI;IACzB,IAAI,CAACC,kBAAkB,GAAG,IAAI;IAC9B,IAAI,CAACC,QAAQ,GAAGL,IAAI,CAACK,QAAQ;IAC7B,IAAI,CAACC,IAAI,GAAGN,IAAI,CAACM,IAAI;IACrB,IAAI,CAAC,CAACR,WAAW,GAAGA,WAAW;IAC/B,IAAI,CAACS,eAAe,GAAG,IAAI;EAC7B;EAEAC,aAAaA,CAACC,KAAK,EAAEC,KAAK,EAAEC,KAAK,EAAE;IACjC,IAAI,CAAC,IAAI,CAACR,aAAa,EAAE,MAAM,IAAIS,KAAK,CAAC,+DAA+D,CAAC;IAEzG,IAAI,CAACH,KAAK,EAAE,MAAM,IAAIG,KAAK,CAAC,6BAA6B,CAAC;IAE1D,IAAI,CAACF,KAAK,EAAEA,KAAK,GAAG,CAAC;IACrB,IAAI,CAACC,KAAK,EAAEA,KAAK,GAAG,CAAC;IAErB,IAAIE,GAAG,GAAG,IAAI,CAACV,aAAa;IAC5B,OACEU,GAAG,CAACJ,KAAK,GAAGA,KAAK,IAChBI,GAAG,CAACJ,KAAK,KAAKA,KAAK,IAAII,GAAG,CAACH,KAAK,GAAGA,KAAM,IACzCG,GAAG,CAACJ,KAAK,KAAKA,KAAK,IAAII,GAAG,CAACH,KAAK,KAAKA,KAAK,IAAIG,GAAG,CAACF,KAAK,IAAIA,KAAM;EAEtE;EAEAG,QAAQA,CAACC,KAAK,EAAEC,OAAO,EAAE;IACvB,OAAO,IAAI,CAAC,CAAClB,WAAW,CAACiB,KAAK,EAAEC,OAAO,CAAC;EAC1C;EAEAC,SAASA,CAAA,EAAG;IACV,IAAI,CAAC,IAAI,CAACd,aAAa,EAAE,MAAM,IAAIS,KAAK,CAAC,kEAAkE,CAAC;IAC5G,OAAO,IAAI,CAACT,aAAa,CAACe,OAAO;EACnC;;EAEA;AACF;AACA;AACA;EACE,OAAOC,kBAAkBA,CAACC,IAAI,EAAE;IAC9B,IAAIC,GAAG;IACP,IAAIC,MAAM,GAAG,CAAC;IACd,IAAIC,IAAI,GAAG,CAAC;IACZ,IAAIC,GAAG,GAAG,CAAC;IAEX,OAAOF,MAAM,GAAGF,IAAI,CAACjB,aAAa,CAACsB,GAAG,CAACC,MAAM,EAAEJ,MAAM,EAAE,EAAE;MACvDD,GAAG,GAAGD,IAAI,CAACjB,aAAa,CAACsB,GAAG,CAACE,UAAU,CAACL,MAAM,CAAC;MAC/C,IAAID,GAAG,GAAG,EAAE,IAAIA,GAAG,GAAG,EAAE,EAAE;QACxB,QAAQE,IAAI;UACV,KAAK,CAAC;YACJH,IAAI,CAACjB,aAAa,CAACM,KAAK,GAAGe,GAAG;YAC9B;UACF,KAAK,CAAC;YACJJ,IAAI,CAACjB,aAAa,CAACO,KAAK,GAAGc,GAAG;YAC9B;UACF,KAAK,CAAC;YACJJ,IAAI,CAACjB,aAAa,CAACQ,KAAK,GAAGa,GAAG;YAC9B;QACJ;QACAD,IAAI,EAAE;QACNC,GAAG,GAAG,CAAC;MACT,CAAC,MAAM;QACLA,GAAG,GAAGA,GAAG,GAAG,EAAE,GAAGH,GAAG,GAAG,EAAE;MAC3B;IACF;IACA;IACA,IAAIE,IAAI,KAAK,CAAC,EAAEH,IAAI,CAACjB,aAAa,CAACQ,KAAK,GAAGa,GAAG;EAChD;AACF;AAEAI,MAAM,CAACC,OAAO,GAAGhC,qBAAqB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}